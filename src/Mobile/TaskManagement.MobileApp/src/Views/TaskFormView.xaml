<?xml version="1.0" encoding="utf-8"?>

<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:TaskManagement.MobileApp.ViewModels"
             xmlns:controls="clr-namespace:TaskManagement.MobileApp.Views.Controls"
             x:Class="TaskManagement.MobileApp.Views.TaskFormView"
             x:DataType="viewModels:TaskFormViewModel">
    <ScrollView BackgroundColor="{StaticResource LightGray}">
        <VerticalStackLayout Padding="16" Spacing="16">
            <VerticalStackLayout Spacing="8">
                <Label Text="Titel:" Style="{StaticResource LabelHeader}" />
                <Grid>
                    <Entry
                        Style="{StaticResource BaseEntry}"
                           Text="{Binding Title}"
                           Placeholder="Voer titel in..." />
                    <controls:TopShadowView />
                </Grid>
            </VerticalStackLayout>
            <VerticalStackLayout Spacing="8">
                <Label Text="Omschrijving:" Style="{StaticResource LabelHeader}" />
                <Grid>
                    <Editor Text="{Binding Description}"
                            Style="{StaticResource BaseEditor}"
                            Placeholder="Voer omschrijving in..." />
                    <controls:TopShadowView />
                </Grid>
            </VerticalStackLayout>
            <VerticalStackLayout Spacing="8">
                <Label Text="Deadline:" Style="{StaticResource LabelHeader}" />
                <!-- SizeChangedHandler is required for winUi to scale this field properly -->
                <Grid HorizontalOptions="FillAndExpand"
                      SizeChanged="OnContainerSizeChanged">
                    <DatePicker x:Name="DeadlinePicker"
                                Date="{Binding DueDate}"
                                Format="dd-MM-yyyy"
                                Style="{StaticResource BaseDatePicker}" />
                    <controls:TopShadowView />
                </Grid>
            </VerticalStackLayout>
            <VerticalStackLayout Spacing="8">
                <Label Text="Gebruiker:" Style="{StaticResource LabelHeader}" />
                <Border Style="{StaticResource PickerBorder}">
                    <Picker Style="{StaticResource BasePicker}"
                            ItemsSource="{Binding Colleagues}"
                            SelectedItem="{Binding AssignedUser}" />
                </Border>
            </VerticalStackLayout>
            <VerticalStackLayout Spacing="8"
                                 IsVisible="{Binding IsNewTask}">
                <Label Text="Object:" Style="{StaticResource LabelHeader}" />
                <!-- The title below might seem weird, picker doesn't have a placeholder and instead uses the Title property.
                Which i find a bit odd but: https://learn.microsoft.com/en-us/dotnet/maui/user-interface/controls/picker?view=net-maui-9.0
                Also this doesnt work on winUI so we only set it on IOS and android. -->
                <Border Style="{StaticResource PickerBorder}">
                    <!-- ReSharper disable once Xaml.BindingWithContextNotResolved; 
                    Name binding resolves, just problem with static compiler reflection i think. -->
                    <Picker Style="{StaticResource BasePicker}"
                            Title="{OnPlatform iOS='Geen', Android='Geen'}"
                            ItemsSource="{Binding ManagedObjects}"
                            SelectedItem="{Binding LinkedObject}"
                            ItemDisplayBinding="{Binding Name}">
                        <Picker.TextColor>
                            <Binding Path="LinkedObject.Type" Converter="{StaticResource TypeToColorConverter}" />
                        </Picker.TextColor>
                    </Picker>
                </Border>
            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentView>